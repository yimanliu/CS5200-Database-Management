"0","# Get the data for fact table"
"0","journal_issn <- dbGetQuery(con, """
"0","SELECT journal_issn FROM ArticleJournal;"
"0",""")"
"0",""
"0","article_id <- dbGetQuery(con, """
"0","SELECT article_id FROM ArticleJournal;"
"0",""")"
"0",""
"0","volume <- dbGetQuery(con, """
"0","SELECT volume FROM ArticleJournal;"
"0",""")"
"0",""
"0","issue <- dbGetQuery(con, """
"0","SELECT issue FROM ArticleJournal;"
"0",""")"
"0",""
"0","cited_medium <- dbGetQuery(con, """
"0","SELECT cited_medium FROM ArticleJournal;"
"0",""")"
"0",""
"0","quarter <- dbGetQuery(con, '"
"0","SELECT CASE"
"0","  WHEN substr(pub_date,1,4) = ""2012"" AND substr(pub_date,6,3) IN (""Jan"", ""Feb"", ""Mar"" ) THEN ""2012-Q1"""
"0","  WHEN substr(pub_date,1,4) = ""2012"" AND substr(pub_date,6,3) IN (""Apr"", ""May"", ""Jun"" ) THEN ""2012-Q2"""
"0","  WHEN substr(pub_date,1,4) = ""2012"" AND substr(pub_date,6,3) IN (""Jul"", ""Aug"", ""Sep"" ) THEN ""2012-Q3"""
"0","  WHEN substr(pub_date,1,4) = ""2012"" AND substr(pub_date,6,3) IN (""Oct"", ""Nov"", ""Dec"" ) THEN ""2012-Q4"""
"0","  WHEN substr(pub_date,1,4) = ""2013"" AND substr(pub_date,6,3) IN (""Jan"", ""Feb"", ""Mar"" ) THEN ""2013-Q1"""
"0","  WHEN substr(pub_date,1,4) = ""2013"" AND substr(pub_date,6,3) IN (""Apr"", ""May"", ""Jun"" ) THEN ""2013-Q2"""
"0","  WHEN substr(pub_date,1,4) = ""2013"" AND substr(pub_date,6,3) IN (""Jul"", ""Aug"", ""Sep"" ) THEN ""2013-Q3"""
"0","  WHEN substr(pub_date,1,4) = ""2013"" AND substr(pub_date,6,3) IN (""Oct"", ""Nov"", ""Dec"" ) THEN ""2013-Q4"""
"0","  ELSE NULL"
"0","  END AS quarter"
"0","FROM ArticleJournal;"
"0","')"
"0",""
"0","# Convert to data frame"
"0","df <-data.frame(journal_issn, article_id, volume, issue, cited_medium, quarter)"
"0",""
"0","print(df)"

"0","xml <- xmlParse('pubmed_sample.xml')"
"0","root <- xmlRoot(xml)"
"0",""
"0","art_pmids <- c()"
"0","art_pub_models <- c()"
"0","art_titles <- c()"
"0","art_paginations <- c()"
"0","art_languages <- c()"
"0","art_dates <- c()"
"0","art_copyrights <- c()"
"0","art_author_list_complete <- c()"
"0",""
"0","art_issns <- c()"
"0","art_volumes <- c()"
"0","art_issues <- c()"
"0","art_pub_dates <- c()"
"0","art_cited_medium <- c()"
"0",""
"0","abs_ids <- c()"
"0","abs_articles <- c()"
"0","abs_labels <- c()"
"0","abs_nlm_categories <- c()"
"0","abs_texts <- c()"
"0",""
"0","hst_ids <- c()"
"0","hst_articles <- c()"
"0","hst_pub_status <- c()"
"0","hst_pub_dates <- c()"
"0",""
"0","jnl_issn <- c()"
"0","jnl_issn_type <- c()"
"0","jnl_titles <- c()"
"0","jnl_iso_abbr <- c()"
"0",""
"0","au_ids <- c()"
"0","au_valids <- c()"
"0","au_last_names <- c()"
"0","au_fore_names <- c()"
"0","au_initials <- c()"
"0","au_affilications <- c()"
"0","au_fullname_to_id <- c()"
"0",""
"0","au_art_auids <- c()"
"0","au_art_artids <- c()"
"0",""
"0","for (idx in 1:xmlSize(root))"
"0","{"
"0","  art_dates[idx] <- NA"
"0","  art_copyrights[idx] <- NA"
"0","  for (i in 1:xmlSize(root[[idx]]))"
"0","  {"
"0","    node <- root[[idx]][[i]]"
"0","    if (xmlName(node) == 'MedlineCitation')"
"0","    {"
"0","      for (j in 1:xmlSize(node))"
"0","      {"
"0","        if (xmlName(node[[j]]) == 'PMID')"
"0","        {"
"0","          art_pmids[idx] <- as.integer(xmlValue(node[[j]]))"
"0","        }"
"0","        else if (xmlName(node[[j]]) == 'Article') {"
"0","          article <- node[[j]]"
"0","          art_pub_models[idx] <- xmlAttrs(article)[1]"
"0","          for (k in 1:xmlSize(article))"
"0","          {"
"0","            if (xmlName(article[[k]]) == 'Journal')"
"0","            {"
"0","              journal <- article[[k]]"
"0","              issn <- xmlValue(journal[[1]])"
"0","              art_issns[idx] <- issn"
"0","              art_cited_medium[idx] <- xmlAttrs(journal[[2]])[1]"
"0","              art_volumes[idx] <- xmlValue(journal[[2]][[1]])"
"0","              art_issues[idx] <- xmlValue(journal[[2]][[2]])"
"0","              art_pub_dates[idx] <- parseDateNode(journal[[2]][[3]])"
"0","              if (!is.element(issn, jnl_issn))"
"0","              {"
"0","                id <- length(jnl_issn) + 1"
"0","                jnl_issn[id] <- issn"
"0","                jnl_issn_type[id] <- xmlAttrs(journal[[1]])[1]"
"0","                jnl_titles[id] <- xmlValue(journal[[3]])"
"0","                jnl_iso_abbr[id] <-xmlValue(journal[[4]])"
"0","              }"
"0","            }"
"0","            else if (xmlName(article[[k]]) == 'ArticleTitle') {"
"0","              art_titles[idx] <- xmlValue(article[[k]])"
"0","            }"
"0","            else if (xmlName(article[[k]]) == 'Pagination') {"
"0","              art_paginations[idx] <- xmlValue(article[[k]][[1]])"
"0","            }"
"0","            else if (xmlName(article[[k]]) == 'Language') {"
"0","              art_languages[idx] <- xmlValue(article[[k]])"
"0","            }"
"0","            else if (xmlName(article[[k]]) == 'ArticleDate') {"
"0","              art_dates[idx] <- parseDateNode(article[[k]])"
"0","            }"
"0","            else if (xmlName(article[[k]]) == 'AuthorList') {"
"0","              authorlist <- article[[k]]"
"0","              if (xmlAttrs(authorlist)[1] == 'Y')"
"0","              {"
"0","                art_author_list_complete[idx] <- TRUE"
"0","              }"
"0","              else {"
"0","                art_author_list_complete[idx] <- FALSE"
"0","              }"
"0","              for (m in 1:xmlSize(authorlist))"
"0","              {"
"0","                author <- authorlist[[m]]"
"0","                last_name <- NA"
"0","                fore_name <- NA"
"0","                initials <- NA"
"0","                affilication <- NA"
"0","                for (n in 1:xmlSize(author))"
"0","                {"
"0","                  if (xmlName(author[[n]]) == 'LastName')"
"0","                  {"
"0","                    last_name <- xmlValue(author[[n]])"
"0","                  }"
"0","                  else if (xmlName(author[[n]]) == 'ForeName') {"
"0","                    fore_name <- xmlValue(author[[n]])"
"0","                  }"
"0","                  else if (xmlName(author[[n]]) == 'Initials') {"
"0","                    initials <- xmlValue(author[[n]])"
"0","                  }"
"0","                  else if (xmlName(author[[n]]) == 'Affiliation') {"
"0","                    affilication <- xmlValue(author[[n]])"
"0","                  }"
"0","                }"
"0","                fullname <- paste0(last_name, '#', fore_name)"
"0","                auid <- NA"
"0","                if (fullname %in% names(au_fullname_to_id))"
"0","                {"
"0","                  auid <- au_fullname_to_id[fullname]"
"0","                }"
"0","                else {"
"0","                  id <- length(au_ids) + 1"
"0","                  auid <- paste0('au_', id)"
"0","                  au_fullname_to_id[fullname] <- auid"
"0","                  au_ids[id] <- auid"
"0","                  if (xmlAttrs(author)[1] =='Y')"
"0","                  {"
"0","                    au_valids[id] <- TRUE"
"0","                  }"
"0","                  else {"
"0","                    au_valids[id] <- FALSE"
"0","                  }"
"0","                  au_last_names[id] <- last_name"
"0","                  au_fore_names[id] <- fore_name"
"0","                  au_initials[id] <- initials"
"0","                  au_affilications[id] <- affilication"
"0","                  "
"0","                  "
"0","                }"
"0","                id <- length(au_art_artids) + 1"
"0","                au_art_auids[id] <- auid"
"0","                au_art_artids[id] <- art_pmids[idx]"
"0","              }"
"0","            }"
"0","            else if (xmlName(article[[k]]) == 'Abstract') {"
"0","              abstract <- article[[k]]"
"0","              abstract_texts <- c()"
"0","              for (m in 1:xmlSize(abstract))"
"0","              {"
"0","                if (xmlName(abstract[[m]]) == 'AbstractText')"
"0","                {"
"0","                  id <- length(abs_ids) + 1"
"0","                  abs_ids[id] <- paste0('abs_', id)"
"0","                  abs_articles[id] <- art_pmids[idx]"
"0","                  abs_texts[id] <- c(abstract_texts, xmlValue(abstract[[m]]))"
"0","                  attrs <- xmlAttrs(abstract[[m]])"
"0","                  if (length(attrs) > 0)"
"0","                  {"
"0","                    abs_labels[id] <- attrs[1]"
"0","                    abs_nlm_categories[id] <- attrs[2]"
"0","                  }"
"0","                  else {"
"0","                    abs_labels[id] <- NA"
"0","                    abs_nlm_categories[id] <- NA"
"0","                  }"
"0","                }"
"0","                else if (xmlName(abstract[[m]]) == 'CopyrightInformation') {"
"0","                  art_copyrights[idx] <- xmlValue(abstract[[m]])"
"0","                }"
"0","              }"
"0","            }"
"0","          }"
"0","        }"
"0","      }"
"0","    }"
"0","    else if (xmlName(node) == 'PubmedData') {"
"0","      for (j in 1:xmlSize(node))"
"0","      {"
"0","        if (xmlName(node[[j]]) == 'History')"
"0","        {"
"0","          history <- node[[j]]"
"0","          for (k in 1:xmlSize(history))"
"0","          {"
"0","            id <- length(hst_ids) + 1"
"0","            hst_ids[id] <- paste0('hst_', id)"
"0","            hst_articles[id] <- art_pmids[idx]"
"0","            hst_pub_status[id] <- xmlAttrs(history[[k]])[1]"
"0","            hst_pub_dates[id] <- parseDateNode(history[[k]])"
"0","          }"
"0","        }"
"0","      }"
"0","    }"
"0","  }"
"0","}"
